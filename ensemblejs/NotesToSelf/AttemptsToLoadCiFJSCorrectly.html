<!DOCTYPE html>
<!-- Project Yarn Main Page -->

<html>
<head>

	<title>CiF Test</title>

	<!-- Include Require.js. The data-main field points to the main.js file which configures all additional Javascript and data files to load. -->
	
	<!--script src="cif.js"></script-->
	<!--script type="text/javascript">




/*
	var delayInMilliseconds = 20;

	function loadScript(url, callback){

	    var script = document.createElement("script")
	    script.type = "text/javascript";

	    if (script.readyState){  //IE
	        script.onreadystatechange = function(){
	            if (script.readyState == "loaded" ||
	                    script.readyState == "complete"){
	                script.onreadystatechange = null;
	                callback();
	            }
	        };
	    } else {  //Others
	        script.onload = function(){
	            callback();
	        };
	    }

	    script.src = url;
	    document.getElementsByTagName("head")[0].appendChild(script);
	}

	var myFunCallback = function(){
		console.log("WAAAAAAT?");
		startTimer();
		var loadResult = cif.init();
	}

	loadScript("cif.js", myFunCallback);


function startTimer () {
    timer.start();
    setTimeout(stopTimer,delayInMilliseconds);
}

function stopTimer () {
    timer.stop;
}
*/

	/*
		window.onload=function(){
			console.log("Document is loaded?");
		};
	*/


/*
		document.addEventListener("load", function (){
			console.log("what what what?");
		});
*/

/*
window.onload = function() {
    var head = document.getElementsByTagName("head")[0];
    var script = document.createElement("script"); 

    script.setAttribute("type", "text/javascript");
    script.setAttribute("src", "cif.js");

    head.addEventListener("load", function(event) {
    	
        if (event.target.nodeName === "SCRIPT")
        {
            alert("Script loaded: " + event.target.getAttribute("src"));

            goofyFunction();
        }
    }, true);

    head.appendChild(script); 
    
}

var goofyFunction = function(){
	console.log("*** hello!?!?!!?");
	var loadResult = cif.init();
}
*/

/*
		//document.addEventListener('DOMContentLoaded', function () {
		//	setTimeout(function() {
		
		window.onload = function(){
				var loadResult = cif.init();
				console.log(loadResult);

				var rawSchema = cif.loadFile("schema.json");
				var schema = cif.loadSocialStructure(rawSchema);

				var rawCast = cif.loadFile("cast.json");
				var cast = cif.addCharacters(rawCast);

				var rawRules = cif.loadFile("testTrigger.json");
				console.log(rawRules);
				var ids = cif.addRules(rawRules);
				console.log("ids", ids);
				ids = cif.addRules(cif.loadFile("samsVolition.json"));
				console.log("ids2", ids);

				var rawActions = cif.loadFile("actions.json");
				var actions = cif.addActions(rawActions);


				// var rawCast = cif.loadFile("cast.json");

				console.log("schema", schema);
				console.log("cast", cast);
				console.log("actions", actions);

				
				//cif.dumpSFDB();

				//var testPredicate = {
				//	"class" : "bond",
				//	"type" : "kinship",
				//	"first" : "brax",
				//	"second" : "grunt",
				//	"value" : 3
				//};

				//cif.set(testPredicate);

				//cif.dumpSFDB();
				

				var storedVolitions = cif.calculateVolition(cast);

				var char1 = "brax";
				var char2 = "grunt";
				var vol = storedVolitions.getFirst(char1, char2);
				console.log(vol);

				var actions = cif.getAction(char1, char2, storedVolitions, cast);
				console.log("Actions: ", actions);

		//	}, 100);
		//})
		}
//*/
	</script-->


</head>
<body>

	<h1>Hello?</h1>

	



<script>
	function loadScript(url, callback)
	{
	    // Adding the script tag to the head as suggested before
	    var head = document.getElementsByTagName('head')[0];
	    console.log("This is what head is : " , head);
	    var script = document.createElement('script');
	    console.log("This is what script is: " , script);
	    script.type = 'text/javascript';
	    script.src = url;

	    // Then bind the event to the callback function.
	    // There are several events for cross browser compatibility.
	    script.onreadystatechange = callback;
	    script.onload = callback;

	    // Fire the loading
	    head.appendChild(script);
	}

	var myPrettyCode = function() {

	   // Here, do what ever you want
	   console.log("my pretty code...");
	   var loadResult = cif.init();
	};

	var myCallBackFunction = function(){
		console.log("What a long strange trip its been.");
		var loadResult = cif.init();
	}

	var loadFile = function(filename) {

		var fileResults;

		if (!window.XMLHttpRequest) {
			console.log("Browser doesn't support XMLHttpRequest.");
			return false;
		}
		xmlhttp = new XMLHttpRequest();
		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState==4 && xmlhttp.status==200) {
				//fileResults = JSON.parse(xmlhttp.responseText);
				fileResults = xmlhttp.responseText;
			    var head = document.getElementsByTagName('head')[0];
			    console.log("This is what head is : " , head);
			    var script = document.createElement('script');
			    console.log("This is what script is: " , script);
			    script.type = 'text/javascript';
			    script.innerHTML = xmlhttp.responseText;
			    head.appendChild(script);
			    console.log("Here is head now... " , head);
			    myCallBackFunction();
				
			} else {
				console.log("xmlhttp not ready!");
				return false;
			}
		}

		xmlhttp.open("GET", filename, false); // false = synchronously
		xmlhttp.send();

		return fileResults;
	}

	var maybeCiF = loadFile("cif.js");


	//console.log("Maybe CiF: " , maybeCiF);

	//loadScript("cif.js", myPrettyCode);
</script>

</body>
<footer>
<script>
/*
	function getScript(url) {
	    e = document.createElement('script');
	    e.src = url;
	    document.body.appendChild(e);
	}
	
	getScript('cif.js');
	*/
</script>
</footer>
</html>